<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment-jalaali@0.9.2/build/moment-jalaali.js"></script>
  <style>

    .calendar-container {
      background: white;
      border-radius: 10px;
      padding: 15px;
      max-width: 100%;
      margin: 20px auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .today-text {
      text-align: center;
      font-size: 16px;
      margin-bottom: 10px;
      cursor: pointer;
      color: #1f1f1f;
      font-weight: 500;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      background-image: url('./Frame 1442.png');
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
      padding: 15px;
      border-radius: 16px;
      position: relative;
    }

    .calendar-header button {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
    }

    .week-days {
      display: flex;
      grid-template-columns: repeat(7, 1fr);
      gap: 10px;
      width: 100%;
    }

    .day {
      width: 100%;
      background: transparent;
      padding: 10px;
      color: #fff;
      text-align: center;
      font-size: 14px;
      position: relative;
      line-height: 29px;
      cursor: pointer;
      border-radius: 16px;
      transition: 0.3s;
    }

    .day.today {
      font-weight: bold;
    }

    .day.active {
      background: #ffffff !important;
      color: #181818 !important;
      font-weight: bold;
      border-radius: 16px;
    }

    #classList {
      margin-top: 30px;
      display: flex;
      flex-direction:column;
      align-items:stretch;
      min-height: 200px;
    }
    .no-result{
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction:column;
      align-items:center;
      justify-content: center;
    }

    .class-card {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 15px;
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 15px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    .class-card:hover{
 
      border: 1px solid #999999;
      box-shadow: 0 2px 5px rgba(187, 187, 187, 0.15);
    }
    .class-card img {
      width: 80px;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
    }

    .class-info {
      flex-grow: 1;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
    }
    .name-info-wrapper{
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 15px;
    }
    .info-wrapper{
      display: flex;
      flex-direction:row;
      justify-content: flex-start;
      gap: 25px;
    }
    .class-info h4 {
      margin: 0;
      font-size: 16px;
      color: #333;
    }

    .class-info p {
      margin: 5px 0;
      font-size: 13px;
      color: #666;
    }

#nextWeek,#prevWeek{
  background-color: #fff;
  padding: 5px;
  border-radius: 10px;
  margin: 0px 20px;
}
    .class-card .start-btn button{
      background-color: #212179;
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 25px;
      cursor: pointer;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    .class-card .start-btn button:hover{
      background-color: #212179f1;
       box-shadow: 0 2px 5px rgba(0,0,0,0.25);
      
    }
.calendar-details{
  display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;
}
.timer-wrapper{
  direction: ltr;
}
    .digit-box {
      border: 1px solid #eaeaea;
      padding: 3px 6px;
      border-radius: 4px;
      margin: 0 1px;
      display: inline-block;
    font-size: 16px;
    color: #333;
    background-color: #f4f4f4;
   
    }

    @media (max-width: 600px) {
      .week-days {
    display: flex;
    gap: 10px;
    width: 100%;
    flex-wrap: wrap;
    justify-content: center;
}
.day{
  width: calc(100% / 7 - 10px);
  padding:7px 12px ;
  font-size: 14px;
   display: flex; 
  flex-direction:column;
    justify-content: space-between;
    align-items: center;
}
.day.active {
    background: #ffffff !important;
    color: #181818 !important;
    font-weight:normal; 
    border-radius: 16px;
}
      .calendar-header {
        flex-direction: column;
        align-items: center;
        padding: 10px;
      }
      .calendar-header button {
        margin-bottom: 10px;
      }
      .class-card {
        flex-direction: column;
        align-items: center;
      }
      .class-card img {
        width: 100px;
        height: 130px;
      }

      .class-card {
        flex-direction: column;
        align-items: flex-start;
      }
      .class-info {
    flex-grow: 1;
     display: flex; 
    flex-direction:column;
    justify-content: space-between;
    align-items: flex-start;
    gap: 20px;
}
      .class-card img {
        width: 80px;
        height: 100px;
      }
      .calendar-details{
  display: flex; 
  flex-direction:column;
    justify-content: space-between;
    align-items: flex-start;
    gap: 5px;
}
#nextWeek,#prevWeek{
  top: 50%;
  position: absolute;
  margin: 0px ;
      padding: 2px;
}
#nextWeek{
  left: 2%;
}
#prevWeek{
  right: 2%;

}

}
  .class-info  p {
    display: flex; 
  flex-direction:column;
    justify-content:center;
    align-items:center;
    gap: 7px;
    font-weight: 300;
  }
  
  </style>
</head>
<body>
  <div class="calendar-container">
    <div class="calendar-details">
      <div class="today-text" id="goToToday"></div>
      <div id="liveClassInfo" style="font-size: 14px; color: #555;">دوره در حال برگزاری: 0 / 0</div>
    </div>
    <div class="calendar-header">
      <button id="prevWeek">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="black" xmlns="http://www.w3.org/2000/svg">
          <path d="M14.43 18.8201C14.24 18.8201 14.05 18.7501 13.9 18.6001C13.61 18.3101 13.61 17.8301 13.9 17.5401L19.44 12.0001L13.9 6.46012C13.61 6.17012 13.61 5.69012 13.9 5.40012C14.19 5.11012 14.67 5.11012 14.96 5.40012L21.03 11.4701C21.32 11.7601 21.32 12.2401 21.03 12.5301L14.96 18.6001C14.81 18.7501 14.62 18.8201 14.43 18.8201Z" fill="#212179"/>
          <path d="M20.33 12.75H3.5C3.09 12.75 2.75 12.41 2.75 12C2.75 11.59 3.09 11.25 3.5 11.25H20.33C20.74 11.25 21.08 11.59 21.08 12C21.08 12.41 20.74 12.75 20.33 12.75Z" fill="#212179"/>
          </svg>
      </button>
      <div class="week-days" id="weekDays"></div>
      <button id="nextWeek">
        
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.57 18.8201C9.76 18.8201 9.95 18.7501 10.1 18.6001C10.39 18.3101 10.39 17.8301 10.1 17.5401L4.56 12.0001L10.1 6.46012C10.39 6.17012 10.39 5.69012 10.1 5.40012C9.81 5.11012 9.33 5.11012 9.04 5.40012L2.97 11.4701C2.68 11.7601 2.68 12.2401 2.97 12.5301L9.04 18.6001C9.19 18.7501 9.38 18.8201 9.57 18.8201Z" fill="#212179"/>
            <path d="M3.67 12.75H20.5C20.91 12.75 21.25 12.41 21.25 12C21.25 11.59 20.91 11.25 20.5 11.25H3.67C3.26 11.25 2.92 11.59 2.92 12C2.92 12.41 3.26 12.75 3.67 12.75Z" fill="#212179"/>
            </svg>
            
      </button>
    </div>
    <div id="classList"></div>
  </div>
  <script>
    moment.loadPersian({ usePersianDigits: false });

    const weekDays = ["شنبه", "یکشنبه", "دوشنبه", "سه‌شنبه", "چهارشنبه", "پنجشنبه", "جمعه"];
    const weekDaysEl = document.getElementById('weekDays');
    const goToTodayText = document.getElementById('goToToday');
    const liveInfo = document.getElementById("liveClassInfo");

    const today = moment();
    let current = moment();
    let selectedDate = moment(today);

    const classData = {
      "2025-04-28": [
        { name: "ریاضی پایه", teacher: "خانم احمدی", time: "10:00 - 11:00", image: "#", link: "#" },
        { name: "علوم تجربی", teacher: "آقای کریمی", time: "13:00 - 14:00", image: "#", link: "#" },
        { name: "ادبیات فارسی", teacher: "خانم حسینی", time: "15:00 - 16:00", image: "#", link: "#" }
      ],
      "2025-04-29": [
        { name: "زبان انگلیسی", teacher: "آقای عباسی", time: "09:00 - 10:00", image: "#", link: "#" },
        { name: "فیزیک", teacher: "خانم مرادی", time: "11:00 - 12:00", image: "#", link: "#" }
      ],
      "2025-04-30": [
        { name: "کامپیوتر مقدماتی", teacher: "آقای رضایی", time: "24:00 - 1:30", image: "./Rectangle 5468.png", link: "#" },
        { name: "زبان انگلیسی", teacher: "آقای عباسی", time: "22:24 - 15:50", image: "./Rectangle 5468.png", link: "#" },
      ],
      "2025-04-31": [
        { name: "کامپیوتر مقدماتی", teacher: "آقای رضایی", time: "24:00 - 1:30", image: "#", link: "#" },
        { name: "زبان انگلیسی", teacher: "آقای عباسی", time: "12:30 - 12:50", image: "#", link: "#" },
      ],
          "2025-06-11": [
        { name: "کامپیوتر مقدماتی", teacher: "آقای رضایی", time: "24:00 - 1:30", image:"./Rectangle 5468.png", link: "#" },
        { name: "زبان انگلیسی", teacher: "آقای عباسی", time: "12:30 - 12:50", image:"./Rectangle 5468.png", link: "#" },
      ]
    };

    function wrapDigit(num) {
      return [...num].map(d => `<span class="digit-box">${d}</span>`).join('');
    }

    function renderClassesFor(dateMoment) {
      const container = document.getElementById("classList");
      container.innerHTML = "";

      const isoDate = dateMoment.format("YYYY-MM-DD");
      const classes = classData[isoDate] || [];
      let liveCount = 0;

      if (classes.length === 0) {
        container.innerHTML = `<div class="no-result"><p>متاسفانه نتیجه ای یافت نشد</p></div>`;
        liveInfo.textContent = "دوره در حال برگزاری: 0 / 0";
        return;
      }

      const now = moment();

      classes.forEach(cls => {
        const card = document.createElement("div");
        card.className = "class-card";

        let contentHTML = "";
        let timerId = "";

        const [start, end] = cls.time.split(" - ");
        const startTime = moment(start, "HH:mm");
        const endTime = moment(end, "HH:mm");

        startTime.set({ year: dateMoment.year(), month: dateMoment.month(), date: dateMoment.date() });
        endTime.set({ year: dateMoment.year(), month: dateMoment.month(), date: dateMoment.date() });

        const isToday = dateMoment.isSame(today, 'day');
        const nowTime = moment();

        if (isToday && nowTime.isBefore(startTime)) {
          timerId = "timer-" + Math.random().toString(36).substr(2, 9);
          contentHTML = `<p id="${timerId}" style="color: black; font-size: 12px;">در حال بارگذاری تایمر...</p>`;
        } else if (isToday && nowTime.isBetween(startTime, endTime)) {
          liveCount++;
          contentHTML = getButtonHTML(cls.link);
        } else {
          contentHTML = getButtonHTML(cls.link);
        }

        card.innerHTML = `
          <img src="${cls.image}" alt="${cls.name}">
          <div class="class-info">
           <div class="name-info-wrapper"> <h4>${cls.name}</h4>
           <div class="info-wrapper"> <p>مدرس دوره:  ${cls.teacher}</p>
            <p>زمان برگزاری: ${cls.time}</p></div></div>
            ${contentHTML}
          </div>
        `;

        container.appendChild(card);

        if (timerId) {
          const el = () => document.getElementById(timerId);
          const intervalFunction = () => {
            const nowTime = moment();
            const diff = startTime.diff(nowTime);
            if (!el()) return;
            if (diff > 0) {
              const duration = moment.duration(diff);
              const hours = String(duration.hours()).padStart(2, '0');
              const minutes = String(duration.minutes()).padStart(2, '0');
              const seconds = String(duration.seconds()).padStart(2, '0');

              el().innerHTML = `
              <div class='timer-wrapper'>
                ${wrapDigit(hours)} : ${wrapDigit(minutes)} : ${wrapDigit(seconds)}<br> 
               
              </div> <div>تا شروع کلاس </div>`;
            } else {
              clearInterval(intervalId);
              el().outerHTML = getButtonHTML(cls.link);
            }
          };
          intervalFunction();
          const intervalId = setInterval(intervalFunction, 1000);
        }
      });

      liveInfo.textContent = `دوره‌های در حال برگزاری: ${liveCount} / ${classes.length}`;
    }

    function getButtonHTML(link) {
      return `<a  href="${link}" class="start-btn"><button>
        
        شروع یادگیری
        <svg width="38" height="22" viewBox="0 0 38 22" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M27.25 0.75H10.25C4.58908 0.75 0 5.33908 0 11C0 16.6609 4.58908 21.25 10.25 21.25H27.25C32.9109 21.25 37.5 16.6609 37.5 11C37.5 5.33908 32.9109 0.75 27.25 0.75Z" fill="white"/>
<path d="M25 10.75H13.5M13.5 10.75L18 6.25M13.5 10.75L18 15.75" stroke="black" stroke-linecap="round"/>
</svg>

        </button></a>`;
    }

    function renderWeek(centerDate) {
      weekDaysEl.innerHTML = "";
      const startOfWeek = moment(centerDate).startOf('week').add(1, 'days');
      for (let i = 0; i < 7; i++) {
        const m = moment(startOfWeek).add(i, 'days');
        const isToday = m.isSame(today, 'day');
        const isSelected = m.isSame(selectedDate, 'day');

        const dayDiv = document.createElement('div');
        dayDiv.className = 'day' + (isToday ? ' today' : '') + (isSelected ? ' active' : '');
        const weekDay = weekDays[i];
        const jDateStr = `${weekDay} <br>${m.jDate()} ${m.format('jMMMM')} `;
        dayDiv.innerHTML = jDateStr;

        dayDiv.addEventListener('click', () => {
          selectedDate = m;
          document.querySelectorAll('.day').forEach(el => el.classList.remove('active'));
          dayDiv.classList.add('active');
          renderClassesFor(m);
        });

        weekDaysEl.appendChild(dayDiv);
      }
    }

    document.getElementById('prevWeek').addEventListener('click', () => {
      current = current.subtract(7, 'days');
      renderWeek(current);
    });

    document.getElementById('nextWeek').addEventListener('click', () => {
      current = current.add(7, 'days');
      renderWeek(current);
    });

    goToTodayText.innerHTML = `
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M8 5.75C7.59 5.75 7.25 5.41 7.25 5V2C7.25 1.59 7.59 1.25 8 1.25C8.41 1.25 8.75 1.59 8.75 2V5C8.75 5.41 8.41 5.75 8 5.75Z" fill="#222222"/>
<path d="M16 5.75C15.59 5.75 15.25 5.41 15.25 5V2C15.25 1.59 15.59 1.25 16 1.25C16.41 1.25 16.75 1.59 16.75 2V5C16.75 5.41 16.41 5.75 16 5.75Z" fill="#222222"/>
<path d="M15 22.75H9C3.38 22.75 2.25 20.1 2.25 15.82V9.65C2.25 4.91 3.85 2.98 7.96 2.75H16C16.01 2.75 16.03 2.75 16.04 2.75C20.15 2.98 21.75 4.91 21.75 9.65V15.82C21.75 20.1 20.62 22.75 15 22.75ZM8 4.25C5.2 4.41 3.75 5.29 3.75 9.65V15.82C3.75 19.65 4.48 21.25 9 21.25H15C19.52 21.25 20.25 19.65 20.25 15.82V9.65C20.25 5.3 18.81 4.41 15.98 4.25H8Z" fill="#222222"/>
<path d="M20.75 18.3501H3.25C2.84 18.3501 2.5 18.0101 2.5 17.6001C2.5 17.1901 2.84 16.8501 3.25 16.8501H20.75C21.16 16.8501 21.5 17.1901 21.5 17.6001C21.5 18.0101 21.16 18.3501 20.75 18.3501Z" fill="#222222"/>
<path d="M12 8.25C10.77 8.25 9.73 8.92 9.73 10.22C9.73 10.84 10.02 11.31 10.46 11.61C9.85 11.97 9.5 12.55 9.5 13.23C9.5 14.47 10.45 15.24 12 15.24C13.54 15.24 14.5 14.47 14.5 13.23C14.5 12.55 14.15 11.96 13.53 11.61C13.98 11.3 14.26 10.84 14.26 10.22C14.26 8.92 13.23 8.25 12 8.25ZM12 11.09C11.48 11.09 11.1 10.78 11.1 10.29C11.1 9.79 11.48 9.5 12 9.5C12.52 9.5 12.9 9.79 12.9 10.29C12.9 10.78 12.52 11.09 12 11.09ZM12 14C11.34 14 10.86 13.67 10.86 13.07C10.86 12.47 11.34 12.15 12 12.15C12.66 12.15 13.14 12.48 13.14 13.07C13.14 13.67 12.66 14 12 14Z" fill="#222222"/>
</svg>

    امروز ${today.jDate()} ${today.format("jMMMM")} ${today.jYear()}`;
    goToTodayText.addEventListener('click', () => {
      current = moment();
      selectedDate = moment(today);
      renderWeek(current);
      renderClassesFor(today);
    });

    renderWeek(current);
    renderClassesFor(today);
  </script>
</body>
</html>
