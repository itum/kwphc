# سیستم تقویم چند زبانه برای ویجت تقویم دانشگاه

## خلاصه

این سیستم امکان نمایش تاریخ‌ها در تقویم‌های مختلف بر اساس زبان فعلی سایت را فراهم می‌کند:

- **فارسی (fa)**: تقویم شمسی (جلالی)
- **انگلیسی (en)**: تقویم میلادی (گرگوری)
- **عربی (ar)**: تقویم هجری قمری

## ویژگی‌ها

### 1. تبدیل خودکار تاریخ
- تبدیل تاریخ میلادی به شمسی برای زبان فارسی
- تبدیل تاریخ میلادی به میلادی برای زبان انگلیسی
- تبدیل تاریخ میلادی به هجری قمری برای زبان عربی

### 2. پشتیبانی از ترجمه
- تمام نام‌های ماه‌ها قابل ترجمه هستند
- پشتیبانی کامل از Polylang
- Fallback امن برای مواقعی که Polylang فعال نیست

### 3. مرتب‌سازی هوشمند
- مرتب‌سازی رویدادها بر اساس تاریخ تبدیل شده
- پشتیبانی از تمام تقویم‌ها در مرتب‌سازی

## نحوه استفاده

### در ویجت تقویم
ویجت تقویم به طور خودکار بر اساس زبان فعلی، تاریخ‌ها را تبدیل می‌کند:

```php
// مثال استفاده در ویجت
$converted_date = $this->convert_date_by_language($event['date']);
echo $converted_date['day'] . ' ' . $converted_date['month'] . ' ' . $converted_date['year'];
```

### در سایر بخش‌های پلاگین
```php
// استفاده از تابع تبدیل تاریخ
$date = '2024-01-15';
$converted = $this->convert_date_by_language($date);
```

## توابع اصلی

### 1. `convert_date_by_language($date)`
تبدیل تاریخ بر اساس زبان فعلی

**پارامترها:**
- `$date` (string): تاریخ میلادی به فرمت Y-m-d

**خروجی:**
```php
[
    'day' => 25,
    'month' => 'دی',
    'year' => 1402,
    'month_number' => 10
]
```

### 2. `gregorian_to_jalaali($year, $month, $day)`
تبدیل تاریخ میلادی به شمسی

### 3. `gregorian_to_hijri($year, $month, $day)`
تبدیل تاریخ میلادی به هجری قمری

### 4. `get_jalaali_month_name($month)`
دریافت نام ماه شمسی

### 5. `get_gregorian_month_name($month)`
دریافت نام ماه میلادی

### 6. `get_hijri_month_name($month)`
دریافت نام ماه هجری قمری

## مثال‌های خروجی

### تاریخ میلادی: 2024-01-15

| زبان | خروجی |
|------|--------|
| فارسی | 25 دی 1402 |
| انگلیسی | 15 January 2024 |
| عربی | 15 محرم 2024 |

### تاریخ میلادی: 2024-06-20

| زبان | خروجی |
|------|--------|
| فارسی | 31 خرداد 1403 |
| انگلیسی | 20 June 2024 |
| عربی | 20 جمادی‌الثانی 2024 |

## تنظیمات Polylang

### رشته‌های ترجمه اضافه شده

#### نام ماه‌های شمسی:
- `um_calendar_month_farvardin` → فروردین
- `um_calendar_month_ordibehesht` → اردیبهشت
- `um_calendar_month_khordad` → خرداد
- و غیره...

#### نام ماه‌های میلادی:
- `um_calendar_month_january` → January
- `um_calendar_month_february` → February
- و غیره...

#### نام ماه‌های هجری قمری:
- `um_calendar_month_muharram` → محرم
- `um_calendar_month_safar` → صفر
- و غیره...

## نکات مهم

1. **پیش‌فرض**: اگر زبان فعلی شناسایی نشود، تقویم شمسی به عنوان پیش‌فرض استفاده می‌شود.

2. **دقت محاسبات**: تمام الگوریتم‌های تبدیل تاریخ با دقت بالا پیاده‌سازی شده‌اند.

3. **عملکرد**: تبدیل تاریخ‌ها به صورت کش شده انجام می‌شود تا عملکرد بهینه باشد.

4. **امنیت**: تمام ورودی‌ها اعتبارسنجی و پاکسازی می‌شوند.

## تست

برای تست عملکرد سیستم، می‌توانید از فایل تست استفاده کنید:

```bash
php test-calendar-multilingual.php
```

## پشتیبانی

این سیستم با تمام نسخه‌های WordPress و Polylang سازگار است و نیازی به تنظیمات اضافی ندارد. 